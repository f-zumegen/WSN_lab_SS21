<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /Users/nikolasmitsakis/Downloads/Elektrotechnik_und_Informationstechnik/Master/4. Semester/WSN_Lab/Project/group4/Project/routing.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">/Users/nikolasmitsakis/Downloads/Elektrotechnik_und_Informationstechnik/Master/4. Semester/WSN_Lab/Project/group4/Project/routing.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;contiki.h&quot;</code><br />
<code>#include &quot;net/rime/rime.h&quot;</code><br />
<code>#include &quot;net/netstack.h&quot;</code><br />
<code>#include &quot;lib/random.h&quot;</code><br />
<code>#include &quot;dev/leds.h&quot;</code><br />
<code>#include &quot;dev/adc-zoul.h&quot;</code><br />
<code>#include &quot;dev/zoul-sensors.h&quot;</code><br />
<code>#include &quot;lib/list.h&quot;</code><br />
<code>#include &quot;lib/memb.h&quot;</code><br />
<code>#include &quot;dev/serial-line.h&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;<a class="el" href="project-conf_8h_source.html">project-conf.h</a>&gt;</code><br />
<code>#include &lt;buffer.c&gt;</code><br />
<code>#include &lt;<a class="el" href="sensor__conversion__functions_8h_source.html">sensor_conversion_functions.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for routing.c:</div>
<div class="dyncontent">
<div class="center"><img src="routing_8c__incl.png" border="0" usemap="#a_2Users_2nikolasmitsakis_2Downloads_2Elektrotechnik__und__Informationstechnik_2Master_24_8_01Semester_2WSN__Lab_2Project_2group4_2Project_2routing_8c" alt=""/></div>
<map name="a_2Users_2nikolasmitsakis_2Downloads_2Elektrotechnik__und__Informationstechnik_2Master_24_8_01Semester_2WSN__Lab_2Project_2group4_2Project_2routing_8c" id="a_2Users_2nikolasmitsakis_2Downloads_2Elektrotechnik__und__Informationstechnik_2Master_24_8_01Semester_2WSN__Lab_2Project_2group4_2Project_2routing_8c">
<area shape="rect" title=" " alt="" coords="938,5,1138,47"/>
<area shape="rect" title=" " alt="" coords="5,95,84,121"/>
<area shape="rect" title=" " alt="" coords="109,95,231,121"/>
<area shape="rect" title=" " alt="" coords="255,95,370,121"/>
<area shape="rect" title=" " alt="" coords="394,95,498,121"/>
<area shape="rect" title=" " alt="" coords="523,95,612,121"/>
<area shape="rect" title=" " alt="" coords="637,95,754,121"/>
<area shape="rect" title=" " alt="" coords="778,95,922,121"/>
<area shape="rect" title=" " alt="" coords="946,95,1021,121"/>
<area shape="rect" title=" " alt="" coords="1045,95,1141,121"/>
<area shape="rect" title=" " alt="" coords="1165,95,1292,121"/>
<area shape="rect" title=" " alt="" coords="1469,169,1535,196"/>
<area shape="rect" title=" " alt="" coords="1840,169,1911,196"/>
<area shape="rect" title=" " alt="" coords="1613,95,1684,121"/>
<area shape="rect" title=" " alt="" coords="1709,95,1791,121"/>
<area shape="rect" href="project-conf_8h.html" title=" " alt="" coords="1867,95,1977,121"/>
<area shape="rect" href="sensor__conversion__functions_8h_source.html" title=" " alt="" coords="1316,95,1539,121"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af8c5c917e0be66bfc489d41186f1d0a3"><td class="memItemLeft" align="right" valign="top"><a id="af8c5c917e0be66bfc489d41186f1d0a3"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#af8c5c917e0be66bfc489d41186f1d0a3">LIST</a> (history_table)</td></tr>
<tr class="memdesc:af8c5c917e0be66bfc489d41186f1d0a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition in "lib/list.h". <br /></td></tr>
<tr class="separator:af8c5c917e0be66bfc489d41186f1d0a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad95d92c1454b779662b363e7f07127cb"><td class="memItemLeft" align="right" valign="top"><a id="ad95d92c1454b779662b363e7f07127cb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#ad95d92c1454b779662b363e7f07127cb">MEMB</a> (history_mem, struct <a class="el" href="structhistory__entry.html">history_entry</a>, <a class="el" href="project-conf_8h.html#af4b0200c85ae7cea713090cb0932e8af">RUNICAST_RX_HISTORY_ENTRIES</a>)</td></tr>
<tr class="memdesc:ad95d92c1454b779662b363e7f07127cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition in "lib/memb.h". <br /></td></tr>
<tr class="separator:ad95d92c1454b779662b363e7f07127cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c49064a1f86024270b5aaa4d5f86d1"><td class="memItemLeft" align="right" valign="top"><a id="aa0c49064a1f86024270b5aaa4d5f86d1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PROCESS</b> (routing_process, &quot;Routing process&quot;)</td></tr>
<tr class="separator:aa0c49064a1f86024270b5aaa4d5f86d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65aabe6a09119ec99c36c8f3aab8043"><td class="memItemLeft" align="right" valign="top"><a id="ac65aabe6a09119ec99c36c8f3aab8043"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PROCESS</b> (send_process, &quot;Send process&quot;)</td></tr>
<tr class="separator:ac65aabe6a09119ec99c36c8f3aab8043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a192e37aa80864c22c853942fcbbe8314"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a192e37aa80864c22c853942fcbbe8314">enqueue_packet</a> (struct <a class="el" href="structlsa.html">lsa</a> tx_pkt, bool <a class="el" href="routing_8c.html#aa6c28d764419d7357e6ad65762928982">forward</a>, bool reply_to_send_lsdb_req, linkaddr_t dst)</td></tr>
<tr class="memdesc:a192e37aa80864c22c853942fcbbe8314"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put a LSA packet in the buffer with a random timer (pre-backoff).  <a href="routing_8c.html#a192e37aa80864c22c853942fcbbe8314">More...</a><br /></td></tr>
<tr class="separator:a192e37aa80864c22c853942fcbbe8314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4099d3bb957be19f10bb5330824013bf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a4099d3bb957be19f10bb5330824013bf">send_lsdb_age</a> (uint8_t dst)</td></tr>
<tr class="memdesc:a4099d3bb957be19f10bb5330824013bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send my LSDB age to dest. Only if age non zero.  <a href="routing_8c.html#a4099d3bb957be19f10bb5330824013bf">More...</a><br /></td></tr>
<tr class="separator:a4099d3bb957be19f10bb5330824013bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6237e89c51d07518ffe50f33f0a6095b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a6237e89c51d07518ffe50f33f0a6095b">send_lsdb_to</a> (uint8_t dst)</td></tr>
<tr class="memdesc:a6237e89c51d07518ffe50f33f0a6095b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send LSDB to destination Our LSDB is (should be) symmetric so we only need to send the upper half without the diagonal and only for the links where the weight is non-zero.  <a href="routing_8c.html#a6237e89c51d07518ffe50f33f0a6095b">More...</a><br /></td></tr>
<tr class="separator:a6237e89c51d07518ffe50f33f0a6095b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af04530796043f9fce0e76c8b9b6a1133"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#af04530796043f9fce0e76c8b9b6a1133">send_runicast_to_neighbours</a> (struct <a class="el" href="structlsa.html">lsa</a> <a class="el" href="routing_8c.html#ae4eb60b53f98c6642da8137319ec3110">tx_lsa_pkt</a>, bool <a class="el" href="routing_8c.html#aa6c28d764419d7357e6ad65762928982">forward</a>)</td></tr>
<tr class="memdesc:af04530796043f9fce0e76c8b9b6a1133"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a unicast packets. When called this function assumes that the packet to be sent is already in the buffer.  <a href="routing_8c.html#af04530796043f9fce0e76c8b9b6a1133">More...</a><br /></td></tr>
<tr class="separator:af04530796043f9fce0e76c8b9b6a1133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc87a65ae68898ab73e49f9ac4badec"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a8dc87a65ae68898ab73e49f9ac4badec">remove_link_from_lsdb</a> (uint8_t src, uint8_t dst, uint8_t seq_nr)</td></tr>
<tr class="memdesc:a8dc87a65ae68898ab73e49f9ac4badec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes link bidirectionally from the local link state database by setting the weight to 0. Calls the <a class="el" href="helper_8c.html#acf416edf6ade83a55705c06de8951e3d" title="Fill LSA packet for transimission.">fill_tx_lsa_pkt()</a> function to fill the packet buffer. Calls the <a class="el" href="routing_8c.html#af04530796043f9fce0e76c8b9b6a1133" title="Sends a unicast packets. When called this function assumes that the packet to be sent is already in t...">send_runicast_to_neighbours()</a> function to forward the link down packet to our neighbours.  <a href="routing_8c.html#a8dc87a65ae68898ab73e49f9ac4badec">More...</a><br /></td></tr>
<tr class="separator:a8dc87a65ae68898ab73e49f9ac4badec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeb2a254da5cde0be147239015c5170f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#aaeb2a254da5cde0be147239015c5170f">add_link_to_lsdb</a> (uint8_t src, uint8_t dst, uint16_t cost, uint8_t seq_nr)</td></tr>
<tr class="memdesc:aaeb2a254da5cde0be147239015c5170f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a directional link to the local link state database.<br  />
Calls the <a class="el" href="helper_8c.html#acf416edf6ade83a55705c06de8951e3d" title="Fill LSA packet for transimission.">fill_tx_lsa_pkt()</a> function passing a packet depending on the sequence number.<br  />
Calls the <a class="el" href="routing_8c.html#af04530796043f9fce0e76c8b9b6a1133" title="Sends a unicast packets. When called this function assumes that the packet to be sent is already in t...">send_runicast_to_neighbours()</a> function to forward the link up packet to our neighbours.  <a href="routing_8c.html#aaeb2a254da5cde0be147239015c5170f">More...</a><br /></td></tr>
<tr class="separator:aaeb2a254da5cde0be147239015c5170f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad36c2e4b5ff638ce7b35794d9827b7c0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#ad36c2e4b5ff638ce7b35794d9827b7c0">broadcast_recv</a> (struct broadcast_conn *c, const linkaddr_t *from)</td></tr>
<tr class="memdesc:ad36c2e4b5ff638ce7b35794d9827b7c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function when we receive a broadcast. We receive a broadcast in two cases: 1) Someone is asking the age of our LSDB. 2) Keep Alive (Hello) packet.  <a href="routing_8c.html#ad36c2e4b5ff638ce7b35794d9827b7c0">More...</a><br /></td></tr>
<tr class="separator:ad36c2e4b5ff638ce7b35794d9827b7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc70dd0e0c5046752ef85578e2be625a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#abc70dd0e0c5046752ef85578e2be625a">runicast_recv</a> (struct runicast_conn *c, const linkaddr_t *from, uint8_t seqno)</td></tr>
<tr class="memdesc:abc70dd0e0c5046752ef85578e2be625a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function when we receive a runicast transmission. Runicast transmissions are used for LSA (Link State Advertisment) packets, aka if a link is up/down.  <a href="routing_8c.html#abc70dd0e0c5046752ef85578e2be625a">More...</a><br /></td></tr>
<tr class="separator:abc70dd0e0c5046752ef85578e2be625a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0dd5a74fd7bb24f9b28f20f5b01807"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a1e0dd5a74fd7bb24f9b28f20f5b01807">unicast_recv</a> (struct unicast_conn *c, const linkaddr_t *from)</td></tr>
<tr class="separator:a1e0dd5a74fd7bb24f9b28f20f5b01807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487418dffd8472534111293ed2975fb5"><td class="memItemLeft" align="right" valign="top"><a id="a487418dffd8472534111293ed2975fb5"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>sent_runicast</b> (struct runicast_conn *c, const linkaddr_t *to, uint8_t retransmissions)</td></tr>
<tr class="separator:a487418dffd8472534111293ed2975fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a2f2edf8a69f6f3d32c59e18fa887e"><td class="memItemLeft" align="right" valign="top"><a id="a73a2f2edf8a69f6f3d32c59e18fa887e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PROCESS_THREAD</b> (send_process, ev, data)</td></tr>
<tr class="separator:a73a2f2edf8a69f6f3d32c59e18fa887e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779c1bf9af6c6408707c1b48da0a2cbf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a779c1bf9af6c6408707c1b48da0a2cbf">PROCESS_THREAD</a> (routing_process, ev, data)</td></tr>
<tr class="separator:a779c1bf9af6c6408707c1b48da0a2cbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acba1ff806aeb7872d7ff5c87ef3ca8c9"><td class="memItemLeft" align="right" valign="top"><a id="acba1ff806aeb7872d7ff5c87ef3ca8c9"></a>
static struct etimer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#acba1ff806aeb7872d7ff5c87ef3ca8c9">keep_alive_timer</a></td></tr>
<tr class="memdesc:acba1ff806aeb7872d7ff5c87ef3ca8c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer to send keep alive packets.<br  />
Used to indicate that a node is still alive. <br /></td></tr>
<tr class="separator:acba1ff806aeb7872d7ff5c87ef3ca8c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f39aed63a397369d444e0f4cba96b20"><td class="memItemLeft" align="right" valign="top"><a id="a8f39aed63a397369d444e0f4cba96b20"></a>
static struct etimer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a8f39aed63a397369d444e0f4cba96b20">down_timer</a></td></tr>
<tr class="memdesc:a8f39aed63a397369d444e0f4cba96b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">If down_timer expires and no keep_alive packets received in that period a node is considered down. <br /></td></tr>
<tr class="separator:a8f39aed63a397369d444e0f4cba96b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd9827d0f265ef99fb38cf0ed2463316"><td class="memItemLeft" align="right" valign="top"><a id="afd9827d0f265ef99fb38cf0ed2463316"></a>
static struct etimer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#afd9827d0f265ef99fb38cf0ed2463316">initial_pre_backoff_timer</a></td></tr>
<tr class="memdesc:afd9827d0f265ef99fb38cf0ed2463316"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer for a intial pre-backoff to avoid congestion and collisions when nodes first go live. <br /></td></tr>
<tr class="separator:afd9827d0f265ef99fb38cf0ed2463316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe05bb390281cff1357bc6952c0c919"><td class="memItemLeft" align="right" valign="top"><a id="aebe05bb390281cff1357bc6952c0c919"></a>
static struct etimer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#aebe05bb390281cff1357bc6952c0c919">get_lsdb_timer</a></td></tr>
<tr class="memdesc:aebe05bb390281cff1357bc6952c0c919"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer to indicate when to ask for the age of the LSDB of my neighbors. Should be smaller than the keep_aliver_timer. <br /></td></tr>
<tr class="separator:aebe05bb390281cff1357bc6952c0c919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22ee1f280aa682a218e07079221f777"><td class="memItemLeft" align="right" valign="top"><a id="aa22ee1f280aa682a218e07079221f777"></a>
static struct etimer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#aa22ee1f280aa682a218e07079221f777">sensor_reading_timer</a></td></tr>
<tr class="memdesc:aa22ee1f280aa682a218e07079221f777"><td class="mdescLeft">&#160;</td><td class="mdescRight">When expired we read an adc3 value and send a data packet containing sensor data. <br /></td></tr>
<tr class="separator:aa22ee1f280aa682a218e07079221f777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3ae6fca2cf1b9f4a48f286745cc8c24"><td class="memItemLeft" align="right" valign="top"><a id="ae3ae6fca2cf1b9f4a48f286745cc8c24"></a>
static struct broadcast_conn&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#ae3ae6fca2cf1b9f4a48f286745cc8c24">broadcast</a></td></tr>
<tr class="memdesc:ae3ae6fca2cf1b9f4a48f286745cc8c24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instance of a broadcast connection. <br /></td></tr>
<tr class="separator:ae3ae6fca2cf1b9f4a48f286745cc8c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1c6ba8ec7327b929e6e6fb60d506267"><td class="memItemLeft" align="right" valign="top"><a id="af1c6ba8ec7327b929e6e6fb60d506267"></a>
static struct unicast_conn&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#af1c6ba8ec7327b929e6e6fb60d506267">unicast</a></td></tr>
<tr class="memdesc:af1c6ba8ec7327b929e6e6fb60d506267"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instance of a unicast connection. <br /></td></tr>
<tr class="separator:af1c6ba8ec7327b929e6e6fb60d506267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6531589d9527f4a09542d1c4b445f0c7"><td class="memItemLeft" align="right" valign="top"><a id="a6531589d9527f4a09542d1c4b445f0c7"></a>
static struct runicast_conn&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a6531589d9527f4a09542d1c4b445f0c7">runicast</a></td></tr>
<tr class="memdesc:a6531589d9527f4a09542d1c4b445f0c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instance of a (r)unicast connection. <br /></td></tr>
<tr class="separator:a6531589d9527f4a09542d1c4b445f0c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add2da152fec36422891a4e697563d5c2"><td class="memItemLeft" align="right" valign="top"><a id="add2da152fec36422891a4e697563d5c2"></a>
static struct <a class="el" href="structkeep__alive__packet.html">keep_alive_packet</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#add2da152fec36422891a4e697563d5c2">rx_ka_pkt</a></td></tr>
<tr class="memdesc:add2da152fec36422891a4e697563d5c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep alive packet for reception. <br /></td></tr>
<tr class="separator:add2da152fec36422891a4e697563d5c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3689e16886980eb3e5d4065eb05b228e"><td class="memItemLeft" align="right" valign="top"><a id="a3689e16886980eb3e5d4065eb05b228e"></a>
static struct <a class="el" href="structkeep__alive__packet.html">keep_alive_packet</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a3689e16886980eb3e5d4065eb05b228e">tx_ka_pkt</a></td></tr>
<tr class="memdesc:a3689e16886980eb3e5d4065eb05b228e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep alive packet for transimission. <br /></td></tr>
<tr class="separator:a3689e16886980eb3e5d4065eb05b228e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d621a16fce71cde11574ce5abd3fac"><td class="memItemLeft" align="right" valign="top"><a id="a20d621a16fce71cde11574ce5abd3fac"></a>
static struct <a class="el" href="structlsa.html">lsa</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a20d621a16fce71cde11574ce5abd3fac">rx_lsa_pkt</a></td></tr>
<tr class="memdesc:a20d621a16fce71cde11574ce5abd3fac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Link State Adverisment packet for reception. <br /></td></tr>
<tr class="separator:a20d621a16fce71cde11574ce5abd3fac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4eb60b53f98c6642da8137319ec3110"><td class="memItemLeft" align="right" valign="top"><a id="ae4eb60b53f98c6642da8137319ec3110"></a>
static struct <a class="el" href="structlsa.html">lsa</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#ae4eb60b53f98c6642da8137319ec3110">tx_lsa_pkt</a></td></tr>
<tr class="memdesc:ae4eb60b53f98c6642da8137319ec3110"><td class="mdescLeft">&#160;</td><td class="mdescRight">Link State Advertisment packet for transimission. <br /></td></tr>
<tr class="separator:ae4eb60b53f98c6642da8137319ec3110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c4e4f852460e41fd59dc4f5e0d1a54"><td class="memItemLeft" align="right" valign="top"><a id="a82c4e4f852460e41fd59dc4f5e0d1a54"></a>
static struct <a class="el" href="structunicast__packet.html">unicast_packet</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a82c4e4f852460e41fd59dc4f5e0d1a54">tx_uni_pkt</a></td></tr>
<tr class="memdesc:a82c4e4f852460e41fd59dc4f5e0d1a54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unicast packet for transmissions. <br /></td></tr>
<tr class="separator:a82c4e4f852460e41fd59dc4f5e0d1a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a854901658950f7658abec3592f84ab8f"><td class="memItemLeft" align="right" valign="top"><a id="a854901658950f7658abec3592f84ab8f"></a>
static struct <a class="el" href="structunicast__packet.html">unicast_packet</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a854901658950f7658abec3592f84ab8f">rx_uni_pkt</a></td></tr>
<tr class="memdesc:a854901658950f7658abec3592f84ab8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unicast packet for reception. <br /></td></tr>
<tr class="separator:a854901658950f7658abec3592f84ab8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6c28d764419d7357e6ad65762928982"><td class="memItemLeft" align="right" valign="top"><a id="aa6c28d764419d7357e6ad65762928982"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#aa6c28d764419d7357e6ad65762928982">forward</a></td></tr>
<tr class="memdesc:aa6c28d764419d7357e6ad65762928982"><td class="mdescLeft">&#160;</td><td class="mdescRight">If forward True we have received an LCA and do reliable forwarding to neighbours. If forward False we generated the packet and reliably flood it to our neighbours. <br /></td></tr>
<tr class="separator:aa6c28d764419d7357e6ad65762928982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e0ceda03c13aa96909dd1da0fae905"><td class="memItemLeft" align="right" valign="top"><a id="ac6e0ceda03c13aa96909dd1da0fae905"></a>
static <a class="el" href="structBuffer.html">Buffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#ac6e0ceda03c13aa96909dd1da0fae905">buffer</a></td></tr>
<tr class="memdesc:ac6e0ceda03c13aa96909dd1da0fae905"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structBuffer.html" title="Buffer structure used for outgoing LSA packets.">Buffer</a> to store packets until TX. <br /></td></tr>
<tr class="separator:ac6e0ceda03c13aa96909dd1da0fae905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ddb7b34cd98fc48dc986c615e4d0f2"><td class="memItemLeft" align="right" valign="top"><a id="a85ddb7b34cd98fc48dc986c615e4d0f2"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a85ddb7b34cd98fc48dc986c615e4d0f2">node_id</a></td></tr>
<tr class="memdesc:a85ddb7b34cd98fc48dc986c615e4d0f2"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classNode.html">Node</a> ID. <br /></td></tr>
<tr class="separator:a85ddb7b34cd98fc48dc986c615e4d0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed0d3f67435119fb874aa798e3171ec"><td class="memItemLeft" align="right" valign="top"><a id="aeed0d3f67435119fb874aa798e3171ec"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#aeed0d3f67435119fb874aa798e3171ec">sender_id</a></td></tr>
<tr class="memdesc:aeed0d3f67435119fb874aa798e3171ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">ID of sender. <br /></td></tr>
<tr class="separator:aeed0d3f67435119fb874aa798e3171ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e285c28c720df320b3b44be9342a47"><td class="memItemLeft" align="right" valign="top"><a id="ac8e285c28c720df320b3b44be9342a47"></a>
static linkaddr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#ac8e285c28c720df320b3b44be9342a47">dst_t</a></td></tr>
<tr class="memdesc:ac8e285c28c720df320b3b44be9342a47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global destination variable used by various functions to construct a link address and send a (r)/unicast. <br /></td></tr>
<tr class="separator:ac8e285c28c720df320b3b44be9342a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacce2f2cabeb301b88c4cf5c07fd7edc"><td class="memItemLeft" align="right" valign="top"><a id="aacce2f2cabeb301b88c4cf5c07fd7edc"></a>
static linkaddr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#aacce2f2cabeb301b88c4cf5c07fd7edc">sensor_dest</a></td></tr>
<tr class="memdesc:aacce2f2cabeb301b88c4cf5c07fd7edc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destination of sensor data. <br /></td></tr>
<tr class="separator:aacce2f2cabeb301b88c4cf5c07fd7edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb0892c097910e45168bda2a965f6be1"><td class="memItemLeft" align="right" valign="top"><a id="adb0892c097910e45168bda2a965f6be1"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#adb0892c097910e45168bda2a965f6be1">rx_ages</a> [<a class="el" href="project-conf_8h.html#a6572362526c5d65ca34ee66976520707">TOTAL_NODES</a>]</td></tr>
<tr class="memdesc:adb0892c097910e45168bda2a965f6be1"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of received ages when first going live. <br /></td></tr>
<tr class="separator:adb0892c097910e45168bda2a965f6be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb980ddf32d7615c08f1211f4e2c35a5"><td class="memItemLeft" align="right" valign="top"><a id="aeb980ddf32d7615c08f1211f4e2c35a5"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#aeb980ddf32d7615c08f1211f4e2c35a5">next_hop</a> [<a class="el" href="project-conf_8h.html#a6572362526c5d65ca34ee66976520707">TOTAL_NODES</a>]</td></tr>
<tr class="memdesc:aeb980ddf32d7615c08f1211f4e2c35a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used when calculating the next hop for data packets. <br /></td></tr>
<tr class="separator:aeb980ddf32d7615c08f1211f4e2c35a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee05bf9e631381c7730c7f67b69e85b"><td class="memItemLeft" align="right" valign="top"><a id="a2ee05bf9e631381c7730c7f67b69e85b"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a2ee05bf9e631381c7730c7f67b69e85b">sequence_number</a></td></tr>
<tr class="memdesc:a2ee05bf9e631381c7730c7f67b69e85b"><td class="mdescLeft">&#160;</td><td class="mdescRight">My sequence number, that i attach to every packet every time i advertise a link update (up/down) <br /></td></tr>
<tr class="separator:a2ee05bf9e631381c7730c7f67b69e85b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b7b6956b74f85784d0854ac257f86f5"><td class="memItemLeft" align="right" valign="top"><a id="a1b7b6956b74f85784d0854ac257f86f5"></a>
static struct <a class="el" href="structlink__state__database.html">link_state_database</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="routing_8c.html#a1b7b6956b74f85784d0854ac257f86f5">lsdb</a></td></tr>
<tr class="memdesc:a1b7b6956b74f85784d0854ac257f86f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Our local link state database. <br /></td></tr>
<tr class="separator:a1b7b6956b74f85784d0854ac257f86f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2021a1cf095c2fa73370f730a4448f32"><td class="memItemLeft" align="right" valign="top"><a id="a2021a1cf095c2fa73370f730a4448f32"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>tx_power</b></td></tr>
<tr class="separator:a2021a1cf095c2fa73370f730a4448f32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bac26ffcc5e8886f40451155e1eb334"><td class="memItemLeft" align="right" valign="top"><a id="a0bac26ffcc5e8886f40451155e1eb334"></a>
static struct broadcast_callbacks&#160;</td><td class="memItemRight" valign="bottom"><b>broadcast_call</b> = {<a class="el" href="routing_8c.html#ad36c2e4b5ff638ce7b35794d9827b7c0">broadcast_recv</a>}</td></tr>
<tr class="separator:a0bac26ffcc5e8886f40451155e1eb334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80a20d51acc47f1b9ba4e08870e21d31"><td class="memItemLeft" align="right" valign="top"><a id="a80a20d51acc47f1b9ba4e08870e21d31"></a>
static struct unicast_callbacks&#160;</td><td class="memItemRight" valign="bottom"><b>unicast_call</b> = {<a class="el" href="routing_8c.html#a1e0dd5a74fd7bb24f9b28f20f5b01807">unicast_recv</a>}</td></tr>
<tr class="separator:a80a20d51acc47f1b9ba4e08870e21d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35cc00cf56aa9f64e6b0cb9e2cdc064a"><td class="memItemLeft" align="right" valign="top"><a id="a35cc00cf56aa9f64e6b0cb9e2cdc064a"></a>
static struct runicast_callbacks&#160;</td><td class="memItemRight" valign="bottom"><b>runicast_call</b> = {<a class="el" href="routing_8c.html#abc70dd0e0c5046752ef85578e2be625a">runicast_recv</a>, sent_runicast}</td></tr>
<tr class="separator:a35cc00cf56aa9f64e6b0cb9e2cdc064a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5ec8df8a387bdef01750bd09db89324"><td class="memItemLeft" align="right" valign="top"><a id="ae5ec8df8a387bdef01750bd09db89324"></a>
AUTOSTART_PROCESSES &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>routing_process</b></td></tr>
<tr class="separator:ae5ec8df8a387bdef01750bd09db89324"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aaeb2a254da5cde0be147239015c5170f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeb2a254da5cde0be147239015c5170f">&#9670;&nbsp;</a></span>add_link_to_lsdb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_link_to_lsdb </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>cost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>seq_nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a directional link to the local link state database.<br  />
Calls the <a class="el" href="helper_8c.html#acf416edf6ade83a55705c06de8951e3d" title="Fill LSA packet for transimission.">fill_tx_lsa_pkt()</a> function passing a packet depending on the sequence number.<br  />
Calls the <a class="el" href="routing_8c.html#af04530796043f9fce0e76c8b9b6a1133" title="Sends a unicast packets. When called this function assumes that the packet to be sent is already in t...">send_runicast_to_neighbours()</a> function to forward the link up packet to our neighbours. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Source of the link. </td></tr>
    <tr><td class="paramname">dst</td><td>Destination of the link. </td></tr>
    <tr><td class="paramname">cost</td><td>Cost of the link. </td></tr>
    <tr><td class="paramname">seq_nr</td><td>Sequence number generated by src. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Link is in DB. Chech sequence numbers.</dd>
<dd>
RX SEQ NR higher than that of our record. Take over value.</dd>
<dd>
RX SEQ NR lower than that of our record. Update what will be forwarded.</dd>
<dd>
RX SEQ NR is the same. Don't do anything.</dd></dl>
<p>@warnign Link not in DB, add it.</p>
<dl class="section warning"><dt>Warning</dt><dd>If src node 1 we dont do anything</dd>
<dd>
Circular sequence number.</dd>
<dd>
If not src/dst 1.</dd>
<dd>
SRC and DST are bridges =&gt; DUPLEX Link.</dd>
<dd>
Circular sequence number.</dd>
<dd>
SRC Bridge and DST Sensor =&gt; Directed link from B-&gt;S.</dd>
<dd>
SRC Sensor and DST Bridge =&gt; Directed link from S-&gt;B.</dd>
<dd>
Circular sequence number.</dd></dl>

</div>
</div>
<a id="ad36c2e4b5ff638ce7b35794d9827b7c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad36c2e4b5ff638ce7b35794d9827b7c0">&#9670;&nbsp;</a></span>broadcast_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void broadcast_recv </td>
          <td>(</td>
          <td class="paramtype">struct broadcast_conn *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const linkaddr_t *&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function when we receive a broadcast. We receive a broadcast in two cases: 1) Someone is asking the age of our LSDB. 2) Keep Alive (Hello) packet. </p>
<dl class="section warning"><dt>Warning</dt><dd>Sender asking for LSDB age.</dd>
<dd>
Add LSDB Age asker to neighbours.</dd>
<dd>
Normal keep alive message.</dd>
<dd>
Neighbour not in list.</dd>
<dd>
My node id is in the received neighbours list.</dd>
<dd>
If we go from 0 keep alive packets received to 1 and the link was previously down, then the link is completely new. Since in the case of a link between sensor and bridge we only add one directed link.</dd>
<dd>
If SRC and DST both have node 1 as neighbour, no need for link between us.</dd>
<dd>
We already have that link. Update to latest cost received from him.</dd>
<dd>
Update link cost of them to send to me. Just for looks.</dd></dl>

</div>
</div>
<a id="a192e37aa80864c22c853942fcbbe8314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a192e37aa80864c22c853942fcbbe8314">&#9670;&nbsp;</a></span>enqueue_packet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void enqueue_packet </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlsa.html">lsa</a>&#160;</td>
          <td class="paramname"><em>tx_pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forward</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reply_to_send_lsdb_req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">linkaddr_t&#160;</td>
          <td class="paramname"><em>dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Put a LSA packet in the buffer with a random timer (pre-backoff). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tx_pkt</td><td>Packet to enqueue @forward Used later with <a class="el" href="routing_8c.html#af04530796043f9fce0e76c8b9b6a1133" title="Sends a unicast packets. When called this function assumes that the packet to be sent is already in t...">send_runicast_to_neighbours()</a>. Definition above. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a779c1bf9af6c6408707c1b48da0a2cbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779c1bf9af6c6408707c1b48da0a2cbf">&#9670;&nbsp;</a></span>PROCESS_THREAD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PROCESS_THREAD </td>
          <td>(</td>
          <td class="paramtype">routing_process&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ev&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>Circular sequence number.</dd>
<dd>
Check if this screws everything up :)</dd></dl>
<p>We have a direct link to the sink.</p>
<p>We don't have a direct link to the sink. Send to bridge with highest battery left.</p>
<p>Since we don't have a link to one.</p>
<dl class="section warning"><dt>Warning</dt><dd>No need to get the LSDB of neighbours, if we are adjacent to the sink.</dd>
<dd>
Only send unicast if node id not 0.</dd></dl>

</div>
</div>
<a id="a8dc87a65ae68898ab73e49f9ac4badec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dc87a65ae68898ab73e49f9ac4badec">&#9670;&nbsp;</a></span>remove_link_from_lsdb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void remove_link_from_lsdb </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>seq_nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes link bidirectionally from the local link state database by setting the weight to 0. Calls the <a class="el" href="helper_8c.html#acf416edf6ade83a55705c06de8951e3d" title="Fill LSA packet for transimission.">fill_tx_lsa_pkt()</a> function to fill the packet buffer. Calls the <a class="el" href="routing_8c.html#af04530796043f9fce0e76c8b9b6a1133" title="Sends a unicast packets. When called this function assumes that the packet to be sent is already in t...">send_runicast_to_neighbours()</a> function to forward the link down packet to our neighbours. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Source of the link. </td></tr>
    <tr><td class="paramname">dst</td><td>Destination of the link (the node that is considered down). </td></tr>
    <tr><td class="paramname">seq_nr</td><td>Sequence number generated by src. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>RX SEQ NR higher than that of our record. Take over value.</dd>
<dd>
RX SEQ NR lower than our record. Update what will the forwarded.</dd></dl>

</div>
</div>
<a id="abc70dd0e0c5046752ef85578e2be625a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc70dd0e0c5046752ef85578e2be625a">&#9670;&nbsp;</a></span>runicast_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void runicast_recv </td>
          <td>(</td>
          <td class="paramtype">struct runicast_conn *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const linkaddr_t *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>seqno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function when we receive a runicast transmission. Runicast transmissions are used for LSA (Link State Advertisment) packets, aka if a link is up/down. </p>
<dl class="section warning"><dt>Warning</dt><dd>We got a reply to our send LSDB request.</dd>
<dd>
Normal LSA.</dd></dl>

</div>
</div>
<a id="a4099d3bb957be19f10bb5330824013bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4099d3bb957be19f10bb5330824013bf">&#9670;&nbsp;</a></span>send_lsdb_age()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void send_lsdb_age </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dst</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send my LSDB age to dest. Only if age non zero. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst</td><td>Destination to send unicast. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Only reply if we have an age bigger than 0.</dd></dl>

</div>
</div>
<a id="a6237e89c51d07518ffe50f33f0a6095b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6237e89c51d07518ffe50f33f0a6095b">&#9670;&nbsp;</a></span>send_lsdb_to()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void send_lsdb_to </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dst</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send LSDB to destination Our LSDB is (should be) symmetric so we only need to send the upper half without the diagonal and only for the links where the weight is non-zero. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>Destinaiton to send LSDB. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Only if non-zero.</dd>
<dd>
If src is not a Sensor mote.</dd></dl>

</div>
</div>
<a id="af04530796043f9fce0e76c8b9b6a1133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af04530796043f9fce0e76c8b9b6a1133">&#9670;&nbsp;</a></span>send_runicast_to_neighbours()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void send_runicast_to_neighbours </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlsa.html">lsa</a>&#160;</td>
          <td class="paramname"><em>tx_lsa_pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forward</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends a unicast packets. When called this function assumes that the packet to be sent is already in the buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">forward</td><td>If true we are forwarding a packet generated from someone else, if false we are runicasting our own generated packet. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Link src.</dd>
<dd>
Link dst.</dd>
<dd>
<a class="el" href="classNode.html">Node</a> id of the sender who send as the runicast packet.</dd>
<dd>
Only to neighbours to which there is an outgoing link.</dd></dl>

</div>
</div>
<a id="a1e0dd5a74fd7bb24f9b28f20f5b01807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e0dd5a74fd7bb24f9b28f20f5b01807">&#9670;&nbsp;</a></span>unicast_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unicast_recv </td>
          <td>(</td>
          <td class="paramtype">struct unicast_conn *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const linkaddr_t *&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Callback function for unicast trasnmissions. We have unicast transmissions when we: 1) Get a reply to our LSDB age reqeust.<br  />
2) Ask from someone for their LSDB.<br  />
3) Get someones LSDB. 4) Normal sensor data transmission. </p>
<dl class="section warning"><dt>Warning</dt><dd>Not a data packet.</dd>
<dd>
Received age to our get age request.</dd>
<dd>
Add LSDB Age sender to neighbour list.</dd>
<dd>
Got LSDB send request.</dd>
<dd>
Data packet.</dd>
<dd>
Package arrived at sink!</dd>
<dd>
We have a direct link to the sink!</dd>
<dd>
We don't have a direct link to the sink!</dd></dl>
<p>Dont send from where you received. We don't have a direct link to the sink. Send to bridge with highest battery left.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
